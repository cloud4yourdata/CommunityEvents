--time traveling
USE CITIBIKE;
USE WAREHOUSE LABSMALL;
USE ROLE SYSADMIN;
--TIME TRAVELING

SELECT * FROM TRIPS LIMIT 100
UPDATE TRIPS SET START_STATION_NAME='EMPTY';

SELECT DISTINCT START_STATION_NAME FROM TRIPS 

--UPDATE QUERY
SELECT * FROM TABLE (information_schema.query_history()) 
WHERE QUERY_TEXT LIKE 'UPDATE%EMPTY%' ORDER BY START_TIME DESC;

SELECT DISTINCT START_STATION_NAME FROM TRIPS  BEFORE(statement=>'018fa1d6-00d4-0901-0000-2d690002245e');

CREATE OR REPLACE TABLE TRIPS_RESTORED CLONE 
    TRIPS  BEFORE(statement=>'018fa1d6-00d4-0901-0000-2d690002245e');
    
SHOW TABLES

ALTER TABLE TRIPS_RESTORED SWAP WITH TRIPS;

SELECT DISTINCT START_STATION_NAME FROM TRIPS 
--DROP TEMP TABLE
DROP TABLE TRIPS 
SELECT DISTINCT START_STATION_NAME FROM TRIPS 

UNDROP TABLE TRIPS 

SELECT DISTINCT START_STATION_NAME FROM TRIPS 